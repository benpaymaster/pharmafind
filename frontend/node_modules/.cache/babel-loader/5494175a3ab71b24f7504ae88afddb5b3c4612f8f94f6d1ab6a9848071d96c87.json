{"ast":null,"code":"var _jsxFileName = \"/home/benpaymaster/pharma-ai-web3/frontend/src/components/PharmacyMap.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup } from \"react-leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CARDIFF_CENTER = [51.4816, -3.1791];\nconst RADIUS_KM = 2;\nfunction haversineDistance(lat1, lon1, lat2, lon2) {\n  function toRad(x) {\n    return x * Math.PI / 180;\n  }\n  const R = 6371; // km\n  const dLat = toRad(lat2 - lat1);\n  const dLon = toRad(lon2 - lon1);\n  const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n}\nconst PharmacyMap = () => {\n  _s();\n  const [pharmacies, setPharmacies] = useState([]);\n  const [userLocation, setUserLocation] = useState(\"\");\n  const [center, setCenter] = useState(CARDIFF_CENTER);\n  const [filteredPharmacies, setFilteredPharmacies] = useState([]);\n  useEffect(() => {\n    fetch(\"/src/data/cardiff_pharmacies.json\").then(res => res.json()).then(data => setPharmacies(data));\n  }, []);\n  useEffect(() => {\n    if (center && pharmacies.length > 0) {\n      const filtered = pharmacies.filter(pharmacy => {\n        const dist = haversineDistance(center[0], center[1], pharmacy.latitude, pharmacy.longitude);\n        return dist <= RADIUS_KM;\n      });\n      setFilteredPharmacies(filtered);\n    }\n  }, [center, pharmacies]);\n  const handleLocationSearch = async e => {\n    e.preventDefault();\n    if (!userLocation) return;\n    // Geocode using Nominatim\n    const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(userLocation + ', Cardiff')}`;\n    const res = await fetch(url);\n    const data = await res.json();\n    if (data && data.length > 0) {\n      setCenter([parseFloat(data[0].lat), parseFloat(data[0].lon)]);\n    } else {\n      alert(\"Location not found\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleLocationSearch,\n      style: {\n        marginBottom: \"1em\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Enter your location (address or postcode):\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: userLocation,\n          onChange: e => setUserLocation(e.target.value),\n          style: {\n            marginLeft: \"1em\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        style: {\n          marginLeft: \"1em\"\n        },\n        children: \"Search\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: center,\n      zoom: 13,\n      style: {\n        height: \"500px\",\n        width: \"100%\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), filteredPharmacies.map((pharmacy, idx) => /*#__PURE__*/_jsxDEV(Marker, {\n        position: [pharmacy.latitude, pharmacy.longitude],\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: pharmacy.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 47\n          }, this), pharmacy.address]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }, this)\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [filteredPharmacies.length, \" pharmacies found within \", RADIUS_KM, \"km.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n_s(PharmacyMap, \"6CR9Od+tgxHNVMMNxERWQUUHF2k=\");\n_c = PharmacyMap;\nexport default PharmacyMap;\nvar _c;\n$RefreshReg$(_c, \"PharmacyMap\");","map":{"version":3,"names":["React","useEffect","useState","MapContainer","TileLayer","Marker","Popup","jsxDEV","_jsxDEV","CARDIFF_CENTER","RADIUS_KM","haversineDistance","lat1","lon1","lat2","lon2","toRad","x","Math","PI","R","dLat","dLon","a","sin","cos","c","atan2","sqrt","PharmacyMap","_s","pharmacies","setPharmacies","userLocation","setUserLocation","center","setCenter","filteredPharmacies","setFilteredPharmacies","fetch","then","res","json","data","length","filtered","filter","pharmacy","dist","latitude","longitude","handleLocationSearch","e","preventDefault","url","encodeURIComponent","parseFloat","lat","lon","alert","children","onSubmit","style","marginBottom","type","value","onChange","target","marginLeft","fileName","_jsxFileName","lineNumber","columnNumber","zoom","height","width","attribution","map","idx","position","name","address","_c","$RefreshReg$"],"sources":["/home/benpaymaster/pharma-ai-web3/frontend/src/components/PharmacyMap.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup } from \"react-leaflet\";\nimport \"leaflet/dist/leaflet.css\";\n\nconst CARDIFF_CENTER = [51.4816, -3.1791];\nconst RADIUS_KM = 2;\n\n\nfunction haversineDistance(lat1, lon1, lat2, lon2) {\n  function toRad(x) { return x * Math.PI / 180; }\n  const R = 6371; // km\n  const dLat = toRad(lat2 - lat1);\n  const dLon = toRad(lon2 - lon1);\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n}\n\nconst PharmacyMap = () => {\n  const [pharmacies, setPharmacies] = useState([]);\n  const [userLocation, setUserLocation] = useState(\"\");\n  const [center, setCenter] = useState(CARDIFF_CENTER);\n  const [filteredPharmacies, setFilteredPharmacies] = useState([]);\n\n  useEffect(() => {\n    fetch(\"/src/data/cardiff_pharmacies.json\")\n      .then((res) => res.json())\n      .then((data) => setPharmacies(data));\n  }, []);\n\n  useEffect(() => {\n    if (center && pharmacies.length > 0) {\n      const filtered = pharmacies.filter(pharmacy => {\n        const dist = haversineDistance(center[0], center[1], pharmacy.latitude, pharmacy.longitude);\n        return dist <= RADIUS_KM;\n      });\n      setFilteredPharmacies(filtered);\n    }\n  }, [center, pharmacies]);\n\n  const handleLocationSearch = async (e) => {\n    e.preventDefault();\n    if (!userLocation) return;\n    // Geocode using Nominatim\n    const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(userLocation + ', Cardiff')}`;\n    const res = await fetch(url);\n    const data = await res.json();\n    if (data && data.length > 0) {\n      setCenter([parseFloat(data[0].lat), parseFloat(data[0].lon)]);\n    } else {\n      alert(\"Location not found\");\n    }\n  };\n\n  return (\n    <div>\n      <form onSubmit={handleLocationSearch} style={{ marginBottom: \"1em\" }}>\n        <label>\n          Enter your location (address or postcode):\n          <input\n            type=\"text\"\n            value={userLocation}\n            onChange={e => setUserLocation(e.target.value)}\n            style={{ marginLeft: \"1em\" }}\n          />\n        </label>\n        <button type=\"submit\" style={{ marginLeft: \"1em\" }}>Search</button>\n      </form>\n      <MapContainer center={center} zoom={13} style={{ height: \"500px\", width: \"100%\" }}>\n        <TileLayer\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        {filteredPharmacies.map((pharmacy, idx) => (\n          <Marker key={idx} position={[pharmacy.latitude, pharmacy.longitude]}>\n            <Popup>\n              <strong>{pharmacy.name}</strong><br />\n              {pharmacy.address}\n            </Popup>\n          </Marker>\n        ))}\n      </MapContainer>\n      <p>{filteredPharmacies.length} pharmacies found within {RADIUS_KM}km.</p>\n    </div>\n  );\n};\n\nexport default PharmacyMap;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}